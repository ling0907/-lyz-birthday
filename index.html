<!doctype html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Happy Birthday</title>
    <link rel="stylesheet" type="text/css" href="css/styles.css">
    <link rel="stylesheet" type="text/css" href="css/mobile.css">
</head>

<style>
    .iframepage {
        -webkit-overflow-scrolling: touch;
        overflow-x: scroll;
        overflow-y: hidden;
    }

    ::-webkit-scrollbar {
        width: 0px;
    }

    /*局部滚动的dom节点*/
    .scroll-el {
        overflow: auto;
    }
</style>

<body>
    <iframe src="./html/login.html" id="iframepage" scrolling="no" onload="changeFrameHeight()" frameborder="0"
        style="width:100%" marginwidth="0" marginheight="0"></iframe>
    <script src="js/jquery-2.1.1.min.js" type="text/javascript"></script>
    <script src="js/jquery-1.8.4.min.js" type="text/javascript"></script>
    
    <script>
        // 强制横屏控制 - 仅在真正的移动设备上生效
        function enforceLandscape() {
            // 更严格的移动设备检测
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            const isSmallScreen = window.innerWidth <= 768;
            const hasCoarsePointer = window.matchMedia('(pointer: coarse)').matches;
            
            // 必须同时满足所有条件才认为是移动设备
            const isRealMobile = isMobile && isTouchDevice && isSmallScreen && hasCoarsePointer;
            
            if (isRealMobile) {
                const isPortrait = window.innerHeight > window.innerWidth;
                
                if (isPortrait) {
                    // 竖屏时强制旋转内容
                    document.body.style.transform = 'rotate(90deg)';
                    document.body.style.transformOrigin = 'left top';
                    document.body.style.position = 'fixed';
                    document.body.style.top = '0';
                    document.body.style.left = '0';
                    document.body.style.width = '100vh';
                    document.body.style.height = '100vw';
                } else {
                    // 横屏时恢复正常
                    document.body.style.transform = 'none';
                    document.body.style.position = 'relative';
                    document.body.style.width = '100%';
                    document.body.style.height = '100%';
                }
            } else {
                // 桌面端：确保没有旋转，正常显示
                document.body.style.transform = 'none';
                document.body.style.position = 'relative';
                document.body.style.width = '100%';
                document.body.style.height = 'auto';
                document.body.style.overflow = 'visible';
            }
        }
        
        // iframe高度自适应函数
        function changeFrameHeight() {
            const iframe = document.getElementById('iframepage');
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            const isSmallScreen = window.innerWidth <= 768;
            const hasCoarsePointer = window.matchMedia('(pointer: coarse)').matches;
            const isRealMobile = isMobile && isTouchDevice && isSmallScreen && hasCoarsePointer;
            
            if (isRealMobile) {
                const isPortrait = window.innerHeight > window.innerWidth;
                
                if (isPortrait) {
                    // 竖屏：iframe需要适应旋转后的尺寸
                    iframe.style.width = '100vh';
                    iframe.style.height = '100vw';
                    document.body.style.overflow = 'hidden';
                    document.documentElement.style.overflow = 'hidden';
                } else {
                    // 横屏：正常显示
                    iframe.style.width = '100%';
                    iframe.style.height = '100vh';
                    document.body.style.overflow = 'hidden';
                    document.documentElement.style.overflow = 'hidden';
                }
            } else {
                // 桌面端：动态计算内容高度
                try {
                    if (iframe.contentWindow && iframe.contentWindow.document.body) {
                        const height = iframe.contentWindow.document.body.scrollHeight;
                        iframe.style.height = height + 'px';
                    }
                } catch (e) {
                    // 跨域情况下使用默认高度
                    iframe.style.height = window.innerHeight + 'px';
                }
                document.body.style.overflow = 'visible';
                document.documentElement.style.overflow = 'visible';
            }
        }
        
        // 监听屏幕方向变化
        window.addEventListener('orientationchange', function() {
            setTimeout(function() {
                enforceLandscape();
                changeFrameHeight();
            }, 200);
        });
        
        // 监听窗口大小变化
        window.addEventListener('resize', function() {
            enforceLandscape();
            changeFrameHeight();
        });
        
        // 页面加载完成后调整
        window.addEventListener('load', function() {
            enforceLandscape();
            changeFrameHeight();
            setTimeout(function() {
                enforceLandscape();
                changeFrameHeight();
            }, 500);
        });
    </script>
</body>

</html>